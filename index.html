<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn by Clicking</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
        }

        #earn-button, #clear-button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        #earn-button:disabled {
            background-color: #a5d6a7;
            cursor: not-allowed;
        }

        #earnings {
            margin-top: 20px;
            font-size: 20px;
        }

        #withdrawal-form {
            display: none;
            flex-direction: column;
            margin-top: 20px;
        }

        #withdrawal-form select,
        #withdrawal-form input {
            margin-bottom: 10px;
            padding: 10px;
            font-size: 16px;
        }

        #withdrawal-form button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #usdt-address,
        #bkash-number {
            display: none;
        }

        .hidden {
            display: none;
        }

        .error {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>

<p style="font-size: 24px; font-weight: bold; color: #4CAF50; text-align: center; padding: 20px; background-color: #f4f4f4; border-radius: 8px;">
  One Click Money Earn
</p>

<p style="font-size:6px; black; color: ; text-align: center; padding: 20px; ">
  আপনি ২৪ ঘন্টায় বা একদিনের মধ্যে ৫০০ টাকার কাজ করতে পারবেন। কনো প্রকার VPN ইউজ করা যাবে না। 
  প্রতি ক্লিকে ০.০১ টাকা করে পাবেন। ক্লিক এর পর মিনিমান ৬ সেকেন্ড wait করতে হবে, তার পর আপনি বেক করে আবার
ক্লিক করতে পারবেন। আপনার Balance ৫০০০টাকা হয়ে গেলে তারপর উইদ্র এর অপশন পেয়ে জাবেন। আপনি চাইলে একমাসে ১৫০০০টাকা পর্যন্ত
ইনকাম করতে পারবেন। ঠিক মতো কাজ করলে অবশ্যই পেমেন্ট পাবেন।    
</p>

<body>
    <button id="earn-button">Click to Earn</button>
    <p id="earnings">Earnings: 0.00 tk</p>
    <button id="clear-button" style="display: none;">Clear Earnings</button>

    <form id="withdrawal-form" action="https://script.google.com/macros/s/AKfycbxL5PQyxTyGbRZHinDNByDPl_h9H5r8LDTtg0YVxGSCauwBupsBivpg4QnnAjbQtTOMtw/exec" method="POST">
        <input type="text" name="name" placeholder="Enter your name" required>
        <input type="email" name="email" placeholder="Enter your email" required>
        <select id="payment-method" name="payment_method" required>
            <option value="" disabled selected>Select Payment Method</option>
            <option value="USDT TRC20">USDT TRC20</option>
            <option value="Bkash">Bkash</option>
        </select>
        <input type="text" id="usdt-address" name="usdt_address" placeholder="Enter USDT TRC20 address" style="display:none;">
        <input type="text" id="bkash-number" name="bkash_number" placeholder="Enter Bkash number" pattern="\d{11}" style="display:none;">
        <input type="number" id="withdraw-amount" name="amount" placeholder="Enter amount to withdraw" min="5000" required>
        <button type="submit">Submit</button>
    </form>

    <p id="error-message" class="error hidden">Insufficient balance</p>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const earnButton = document.getElementById('earn-button');
            const clearButton = document.getElementById('clear-button');
            const earningsDisplay = document.getElementById('earnings');
            const withdrawalForm = document.getElementById('withdrawal-form');
            const paymentMethodSelect = document.getElementById('payment-method');
            const usdtAddressInput = document.getElementById('usdt-address');
            const bkashNumberInput = document.getElementById('bkash-number');
            const withdrawAmountInput = document.getElementById('withdraw-amount');
            const errorMessage = document.getElementById('error-message');

            let earnings = parseFloat(localStorage.getItem('earnings')) || 0.00;
            let dailyEarnings = parseFloat(localStorage.getItem('dailyEarnings')) || 0.00;
            let lastEarnDate = localStorage.getItem('lastEarnDate') || new Date().toISOString().split('T')[0];
            const clickTimestampKey = 'lastClickTimestamp';
            const clickDelay = 2500; // 2.5 seconds delay
            const dailyLimit = 500;
            const withdrawThreshold = 5000;
            const allowedIPs = ['103.25.248.128', '2404:1c40:95:21cb:1:0:75db:183a']; // Allowed IPs

            // Update the earnings display
            function updateEarningsDisplay() {
                earningsDisplay.textContent = `Earnings: ${earnings.toFixed(2)} tk`;
            }

            // Save earnings to localStorage
            function saveEarnings() {
                localStorage.setItem('earnings', earnings.toFixed(2));
                localStorage.setItem('dailyEarnings', dailyEarnings.toFixed(2));
                localStorage.setItem('lastEarnDate', lastEarnDate);
            }

            function updateEarnings(amount) {
                const today = new Date().toISOString().split('T')[0];
                if (lastEarnDate !== today) {
                    dailyEarnings = 0;
                    lastEarnDate = today;
                }

                if (dailyEarnings + amount <= dailyLimit) {
                    earnings += amount;
                    dailyEarnings += amount;
                    saveEarnings();
                }

                updateEarningsDisplay();
            }

            function handleButtonClick() {
                const redirectUrl = 'https://www.profitablecpmrate.com/pumcfhe0?key=bf245538c69c40f2c946438a12662307'; // Updated link
                // Save the click timestamp for adding earnings later
                localStorage.setItem('clickTimestamp', Date.now());
                // Redirect instantly
                window.location.href = redirectUrl;

                // Automatically refresh the page after 6 seconds
                setTimeout(function() {
                    location.reload();  // This reloads the page after 6 seconds
                }, 6000);  // 6000 milliseconds = 6 seconds
            }

            // Check if earnings need to be added (after redirect)
            function addEarningsAfterRedirect() {
                const clickTimestamp = localStorage.getItem('clickTimestamp');
                if (clickTimestamp && Date.now() - parseInt(clickTimestamp) >= 5500) {
                    // Add credit after 5.5 seconds delay
                    updateEarnings(0.01); // Add 0.01 tk to the earnings
                    localStorage.removeItem('clickTimestamp'); // Remove timestamp after adding earnings
                }
            }

            // Check IP and decide if the withdrawal form can be shown
            function checkIPandShowForm() {
                fetch('https://api64.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        const userIP = data.ip;
                        localStorage.setItem('userIP', userIP);

                        // Show withdrawal form if the IP is allowed or balance is sufficient
                        if (allowedIPs.includes(userIP)) {
                            withdrawalForm.style.display = 'flex'; // Allow form submission even if earnings < 5000 tk
                            clearButton.style.display = 'inline-block'; // Show the clear button for allowed IPs
                        } else if (earnings >= withdrawThreshold) {
                            withdrawalForm.style.display = 'flex';
                        } else {
                            clearButton.style.display = 'none'; // Keep the clear button hidden for other IPs
                        }
                    })
                    .catch(error => console.error('Error fetching IP address:', error));
            }

            earnButton.addEventListener('click', handleButtonClick);

            clearButton.addEventListener('click', function() {
                earnings = 0.00;
                dailyEarnings = 0.00;
                lastEarnDate = new Date().toISOString().split('T')[0];
                saveEarnings();
                updateEarningsDisplay();
            });

            withdrawalForm.addEventListener('submit', function(event) {
                const withdrawAmount = parseFloat(withdrawAmountInput.value);

                // If the user's IP is in the allowed list, allow form submission regardless of the balance
                const userIP = localStorage.getItem('userIP');
                if (allowedIPs.includes(userIP) || withdrawAmount <= earnings) {
                    errorMessage.classList.add('hidden');
                } else {
                    event.preventDefault();
                    errorMessage.classList.remove('hidden');
                    errorMessage.textContent = 'Insufficient balance';
                }
            });

            // Show and hide payment method input fields
            paymentMethodSelect.addEventListener('change', function() {
                if (this.value === 'USDT TRC20') {
                    usdtAddressInput.style.display = 'block';
                    bkashNumberInput.style.display = 'none';
                } else if (this.value === 'Bkash') {
                    usdtAddressInput.style.display = 'none';
                    bkashNumberInput.style.display = 'block';
                } else {
                    usdtAddressInput.style.display = 'none';
                    bkashNumberInput.style.display = 'none';
                }
            });

            // Check and add earnings after page load if necessary
            addEarningsAfterRedirect();

            checkIPandShowForm(); // Check user IP on page load
            updateEarningsDisplay();
        });
    </script>
</body>
</html>
